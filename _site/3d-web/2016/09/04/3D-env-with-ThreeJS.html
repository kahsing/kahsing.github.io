<!DOCTYPE html>
<html lang="en-US">
  <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.6.1 -->
<title>The Very First Prototyping With ThreeJS, PhysiJS and THREEx. | Sean Pang</title>
<meta name="generator" content="Jekyll v3.8.6" />
<meta property="og:title" content="The Very First Prototyping With ThreeJS, PhysiJS and THREEx." />
<meta name="author" content="Sean Pang" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Virtual Reality? All I ever wanted to build since was a virtual shopping mall. Turning around 360 degrees, glancing ambience made ups with partially real objects, a place where you can build your world! Let&#39;s get it started -- having a first impression rather than building one virtual world in too soon! I&#39;m doing my very first prototyping with ThreeJS, PhysiJS and THREEx." />
<meta property="og:description" content="Virtual Reality? All I ever wanted to build since was a virtual shopping mall. Turning around 360 degrees, glancing ambience made ups with partially real objects, a place where you can build your world! Let&#39;s get it started -- having a first impression rather than building one virtual world in too soon! I&#39;m doing my very first prototyping with ThreeJS, PhysiJS and THREEx." />
<link rel="canonical" href="http://localhost:4000/3d-web/2016/09/04/3D-env-with-ThreeJS.html" />
<meta property="og:url" content="http://localhost:4000/3d-web/2016/09/04/3D-env-with-ThreeJS.html" />
<meta property="og:site_name" content="Sean Pang" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2016-09-04T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"Virtual Reality? All I ever wanted to build since was a virtual shopping mall. Turning around 360 degrees, glancing ambience made ups with partially real objects, a place where you can build your world! Let&#39;s get it started -- having a first impression rather than building one virtual world in too soon! I&#39;m doing my very first prototyping with ThreeJS, PhysiJS and THREEx.","author":{"@type":"Person","name":"Sean Pang"},"@type":"BlogPosting","url":"http://localhost:4000/3d-web/2016/09/04/3D-env-with-ThreeJS.html","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/assets/img/signage.png"},"name":"Sean Pang"},"headline":"The Very First Prototyping With ThreeJS, PhysiJS and THREEx.","dateModified":"2016-09-04T00:00:00+08:00","datePublished":"2016-09-04T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/3d-web/2016/09/04/3D-env-with-ThreeJS.html"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <!--[if lt IE 9]>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <nav>
            <a href="/pages/about"><h3 class="link">About</h3></a>
            <!-- <a href="/pages/contact"><h3 class="link">Contact</h3></a> -->
            <a href="/pages/story"><h3 class="link">Stories</h3></a>
        </nav>
      </header>
      <section>

      <small>4 September 2016</small>
<h1>The Very First Prototyping With ThreeJS, PhysiJS and THREEx.</h1>

<p>Virtual Reality? All I ever wanted to build since was a virtual shopping mall. Turning around 360 degrees, glancing ambience made ups with partially real objects, a place where you can build your world! Let's get it started -- having a first impression rather than building one virtual world in too soon! I'm doing my very first prototyping with ThreeJS, PhysiJS and THREEx.</p>

<h5 id="some-brief-introduction">Some Brief Introduction</h5>

<ul>
  <li>Three.js is a 3D library that tries to make it as easy as possible to get 3D content on a webpage.</li>
  <li>Physijs takes that philosophy to heart and makes physics simulations just as easy to run and is so easy for graphics newbies to get into 3D programming.</li>
  <li>THREEx is games extensions for three.js.</li>
</ul>

<h5 id="references">References</h5>

<ul>
  <li>https://threejs.org/</li>
  <li>https://github.com/chandlerprall/Physijs</li>
  <li>http://learningthreejs.com/data/THREEx/docs/THREEx.KeyboardState.html</li>
</ul>

<h3 id="3d-environment-prototyping">3D Environment Prototyping</h3>

<iframe width="560" height="315" src="https://www.youtube.com/embed/c2_pkOd9n4A" frameborder="0" allowfullscreen=""></iframe>

<h4 id="include-threejs-and-some-main-three-scene-required-js">Include ThreeJS And Some Main Three-scene-required Js</h4>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="o">&lt;</span><span class="nx">script</span> <span class="nx">type</span><span class="o">=</span><span class="dl">"</span><span class="s2">text/javascript</span><span class="dl">"</span> <span class="nx">src</span><span class="o">=</span><span class="dl">"</span><span class="s2">lib/js/3/Three.js</span><span class="dl">"</span><span class="o">&gt;&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span>
    <span class="o">&lt;</span><span class="nx">script</span> <span class="nx">type</span><span class="o">=</span><span class="dl">"</span><span class="s2">text/javascript</span><span class="dl">"</span> <span class="nx">src</span><span class="o">=</span><span class="dl">"</span><span class="s2">lib/js/3/requestAnimFrame.js</span><span class="dl">"</span><span class="o">&gt;&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span>    <span class="o">&lt;</span><span class="nx">script</span> <span class="nx">type</span><span class="o">=</span><span class="dl">"</span><span class="s2">text/javascript</span><span class="dl">"</span> <span class="nx">src</span><span class="o">=</span><span class="dl">"</span><span class="s2">lib/js/3/Stats.js</span><span class="dl">"</span><span class="o">&gt;&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span>    <span class="o">&lt;</span><span class="nx">script</span> <span class="nx">type</span><span class="o">=</span><span class="dl">"</span><span class="s2">text/javascript</span><span class="dl">"</span> <span class="nx">src</span><span class="o">=</span><span class="dl">"</span><span class="s2">lib/js/3/Detector.js</span><span class="dl">"</span><span class="o">&gt;&lt;</span><span class="sr">/script&gt;</span><span class="err">s
</span>
    <span class="o">&lt;</span><span class="nx">script</span> <span class="nx">type</span><span class="o">=</span><span class="dl">"</span><span class="s2">text/javascript</span><span class="dl">"</span> <span class="nx">src</span><span class="o">=</span><span class="dl">"</span><span class="s2">lib/js/3/effects/Mirror.js</span><span class="dl">"</span><span class="o">&gt;&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span></code></pre></div></div>

<h4 id="include-threex-game-extensions-for-threejs">Include THREEx Game Extensions for Three.js</h4>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="o">&lt;</span><span class="nx">script</span> <span class="nx">type</span><span class="o">=</span><span class="dl">"</span><span class="s2">text/javascript</span><span class="dl">"</span> <span class="nx">src</span><span class="o">=</span><span class="dl">"</span><span class="s2">lib/js/3/THREEx.FullScreen.js</span><span class="dl">"</span><span class="o">&gt;&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span>    <span class="o">&lt;</span><span class="nx">script</span> <span class="nx">type</span><span class="o">=</span><span class="dl">"</span><span class="s2">text/javascript</span><span class="dl">"</span> <span class="nx">src</span><span class="o">=</span><span class="dl">"</span><span class="s2">lib/js/3/THREEx.KeyboardState.js</span><span class="dl">"</span><span class="o">&gt;&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span>    <span class="o">&lt;</span><span class="nx">script</span> <span class="nx">type</span><span class="o">=</span><span class="dl">"</span><span class="s2">text/javascript</span><span class="dl">"</span> <span class="nx">src</span><span class="o">=</span><span class="dl">"</span><span class="s2">lib/js/3/THREEx.WindowResize.js</span><span class="dl">"</span><span class="o">&gt;&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span>    <span class="o">&lt;</span><span class="nx">script</span> <span class="nx">type</span><span class="o">=</span><span class="dl">"</span><span class="s2">text/javascript</span><span class="dl">"</span> <span class="nx">src</span><span class="o">=</span><span class="dl">"</span><span class="s2">lib/js/3/THREEx.CubeCamera.js</span><span class="dl">"</span><span class="o">&gt;&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span>    <span class="o">&lt;</span><span class="nx">script</span> <span class="nx">type</span><span class="o">=</span><span class="dl">"</span><span class="s2">text/javascript</span><span class="dl">"</span> <span class="nx">src</span><span class="o">=</span><span class="dl">"</span><span class="s2">lib/js/3/Raycaster.js</span><span class="dl">"</span><span class="o">&gt;&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span>    <span class="o">&lt;</span><span class="nx">script</span> <span class="nx">type</span><span class="o">=</span><span class="dl">"</span><span class="s2">text/javascript</span><span class="dl">"</span> <span class="nx">src</span><span class="o">=</span><span class="dl">"</span><span class="s2">lib/js/3/TrackballControls.js</span><span class="dl">"</span><span class="o">&gt;&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span></code></pre></div></div>
<blockquote>
<small>
So that these gives us extra control to interact with the Three's scene.
Eg: Move, Rotate, Click etc.
</small>
</blockquote>

<h4 id="include-threes-loaders">Include Three’s Loaders</h4>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="o">&lt;</span><span class="nx">script</span> <span class="nx">type</span><span class="o">=</span><span class="dl">"</span><span class="s2">text/javascript</span><span class="dl">"</span> <span class="nx">src</span><span class="o">=</span><span class="dl">"</span><span class="s2">lib/js/3/loader/ColladaLoader.js</span><span class="dl">"</span><span class="o">&gt;&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span></code></pre></div></div>
<blockquote>
<small>
We use the loaders to inlude 3D models files with .Dae extension. 
Of course there are others possible loaders from Three to be used (eg. OBJLoader2, MTLLoader2, ALLoader, JSONLoader). However in this case, we are using ColladaLoader for demonstration purpose :)
</small>
</blockquote>

<h4 id="finally-we-also-include-physics-plugin-for-threejs">Finally We Also Include Physics plugin for three.js</h4>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="o">&lt;</span><span class="nx">script</span> <span class="nx">type</span><span class="o">=</span><span class="dl">"</span><span class="s2">text/javascript</span><span class="dl">"</span> <span class="nx">src</span><span class="o">=</span><span class="dl">"</span><span class="s2">lib/js/physijs/physi.js</span><span class="dl">"</span><span class="o">&gt;&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span></code></pre></div></div>
<blockquote>
    <small>Physijs takes that philosophy to heart and makes physics simulations just as easy to run.</small>
</blockquote>

<h4 id="html-element-for-threescene-to-be-created">Html Element for ThreeScene to Be Created.</h4>
<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"ThreeJS"</span> <span class="na">class=</span><span class="s">"toucharea"</span> <span class="nt">&gt;&lt;/div&gt;</span>
</code></pre></div></div>

<hr />

<h4 id="scripting">Scripting</h4>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ready</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
    <span class="kd">var</span> <span class="nx">$touchArea</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="dl">'</span><span class="s1">#ThreeJS</span><span class="dl">'</span><span class="p">),</span> 
                    <span class="nx">touchStarted</span><span class="o">=</span> <span class="kc">false</span><span class="p">,</span>
                    <span class="nx">currX</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                    <span class="nx">currY</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                    <span class="nx">cachedX</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                    <span class="nx">cachedY</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

                <span class="kd">var</span> <span class="nx">controls</span><span class="p">,</span> <span class="nx">stats</span><span class="p">;</span>
                <span class="kd">var</span> <span class="nx">keyboard</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREEx</span><span class="p">.</span><span class="nx">KeyboardState</span><span class="p">();</span>
                <span class="kd">var</span> <span class="nx">clock</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Clock</span><span class="p">();</span>

                <span class="kd">var</span> <span class="nx">cube</span><span class="p">;</span>
                <span class="kd">var</span> <span class="nx">mouse</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Vector2</span><span class="p">();</span>   

                <span class="kd">var</span> <span class="nx">directionVector</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Vector3</span><span class="p">();</span>
    
                <span class="kd">var</span> <span class="nx">clock</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Clock</span><span class="p">();</span>
                <span class="kd">var</span> <span class="nx">loader</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">TextureLoader</span><span class="p">();</span>
                
                <span class="c1">//SCENE</span>
                <span class="nx">scene</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Physijs</span><span class="p">.</span><span class="nx">Scene</span><span class="p">();</span>
                <span class="nx">scene</span><span class="p">.</span><span class="nx">setGravity</span><span class="p">(</span><span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Vector3</span><span class="p">(</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="mi">0</span> <span class="p">));</span>
                <span class="nx">projector</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Projector</span><span class="p">();</span>
                
                <span class="c1">// EVENTS </span>
                <span class="nx">THREEx</span><span class="p">.</span><span class="nx">WindowResize</span><span class="p">(</span><span class="nx">renderer</span><span class="p">,</span> <span class="nx">textureCamera</span><span class="p">);</span>
                <span class="nx">THREEx</span><span class="p">.</span><span class="nx">FullScreen</span><span class="p">.</span><span class="nx">bindKey</span><span class="p">({</span> <span class="na">charCode</span> <span class="p">:</span> <span class="dl">'</span><span class="s1">m</span><span class="dl">'</span><span class="p">.</span><span class="nx">charCodeAt</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="p">});</span>

                <span class="nx">id</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span> <span class="dl">'</span><span class="s1">ThreeJS</span><span class="dl">'</span> <span class="p">);</span>

                <span class="c1">// Initialize Loader</span>
                <span class="kd">var</span> <span class="nx">texture1</span><span class="o">=</span><span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Texture</span><span class="p">();</span>
                <span class="kd">var</span> <span class="nx">manager</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">LoadingManager</span><span class="p">();</span>
                <span class="kd">var</span> <span class="nx">obj_loader</span><span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">OBJLoader</span><span class="p">(</span><span class="nx">manager</span><span class="p">);</span>

                <span class="nx">THREE</span><span class="p">.</span><span class="nx">DefaultLoadingManager</span><span class="p">.</span><span class="nx">onProgress</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span> <span class="nx">item</span><span class="p">,</span> <span class="nx">loaded</span><span class="p">,</span> <span class="nx">total</span> <span class="p">)</span> <span class="p">{</span>
                    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="nx">item</span><span class="p">,</span> <span class="nx">loaded</span><span class="p">,</span> <span class="nx">total</span> <span class="p">);</span>
                <span class="p">};</span>
    <span class="p">});</span>
</code></pre></div></div>

<h4 id="add-camera-to-scnene">Add Camera To Scnene</h4>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="c1">//CAMERA</span>
    <span class="kd">var</span> <span class="nx">VIEW_ANGLE</span> <span class="o">=</span> <span class="mi">45</span><span class="p">,</span> <span class="nx">ASPECT</span> <span class="o">=</span> <span class="nx">SCREEN_WIDTH</span> <span class="o">/</span> <span class="nx">SCREEN_HEIGHT</span><span class="p">,</span> <span class="nx">NEAR</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span> <span class="nx">FAR</span> <span class="o">=</span> <span class="mi">20000</span><span class="p">;</span>
    <span class="nx">camera</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">PerspectiveCamera</span><span class="p">(</span> <span class="mi">50</span><span class="p">,</span> <span class="nb">window</span><span class="p">.</span><span class="nx">innerWidth</span> <span class="o">/</span> <span class="nb">window</span><span class="p">.</span><span class="nx">innerHeight</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">20000</span> <span class="p">);</span>
    <span class="nx">textureCamera</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">PerspectiveCamera</span><span class="p">(</span> <span class="nx">VIEW_ANGLE</span><span class="p">,</span> <span class="nx">ASPECT</span><span class="p">,</span> <span class="nx">NEAR</span><span class="p">,</span> <span class="nx">FAR</span> <span class="p">);</span>

    <span class="nx">renderer</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">WebGLRenderer</span><span class="p">();</span>
    <span class="nx">renderer</span><span class="p">.</span><span class="nx">setSize</span><span class="p">(</span> <span class="nb">window</span><span class="p">.</span><span class="nx">innerWidth</span><span class="p">,</span> <span class="nb">window</span><span class="p">.</span><span class="nx">innerHeight</span> <span class="p">);</span>
    <span class="nx">renderer</span><span class="p">.</span><span class="nx">setClearColor</span><span class="p">(</span><span class="mh">0xEEEEEE</span><span class="p">,</span><span class="mf">1.0</span><span class="p">);</span>
    <span class="nx">effect</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">StereoEffect</span><span class="p">(</span><span class="nx">renderer</span><span class="p">);</span>
</code></pre></div></div>

<h4 id="add-control-mechanism">Add Control Mechanism</h4>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="c1">//Controls</span>
    <span class="nx">controls</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">TrackballControls</span><span class="p">(</span> <span class="nx">textureCamera</span> <span class="p">);</span>
    <span class="nx">controls</span><span class="p">.</span><span class="nx">rotateSpeed</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">;</span>
    <span class="nx">controls</span><span class="p">.</span><span class="nx">zoomSpeed</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">;</span>
    <span class="nx">controls</span><span class="p">.</span><span class="nx">panSpeed</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">;</span>
    <span class="nx">controls</span><span class="p">.</span><span class="nx">noZoom</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
    <span class="nx">controls</span><span class="p">.</span><span class="nx">noPan</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
    <span class="nx">controls</span><span class="p">.</span><span class="nx">staticMoving</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
    <span class="nx">controls</span><span class="p">.</span><span class="nx">dynamicDampingFactor</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">;</span>
</code></pre></div></div>

<h4 id="adding-stats-to-monitor-performance">Adding STATS To Monitor Performance</h4>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="c1">// STATS</span>
    <span class="nx">stats</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Stats</span><span class="p">();</span>
    <span class="nx">stats</span><span class="p">.</span><span class="nx">domElement</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">position</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">absolute</span><span class="dl">'</span><span class="p">;</span>
    <span class="nx">stats</span><span class="p">.</span><span class="nx">domElement</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">bottom</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">0px</span><span class="dl">'</span><span class="p">;</span>
    <span class="nx">stats</span><span class="p">.</span><span class="nx">domElement</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">zIndex</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>
    <span class="nx">id</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span> <span class="nx">stats</span><span class="p">.</span><span class="nx">domElement</span> <span class="p">);</span>
</code></pre></div></div>

<h4 id="add-enought-light-souce-to-the-scene">Add Enought Light Souce To The Scene</h4>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="c1">//Add Direction Light Source Object</span>
    <span class="kd">var</span> <span class="nx">directionalLight</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">DirectionalLight</span><span class="p">(</span><span class="mh">0xffffff</span><span class="p">,</span><span class="mf">0.2</span><span class="p">);</span>
    <span class="nx">directionalLight</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span> <span class="p">).</span><span class="nx">normalize</span><span class="p">();</span>
    <span class="kd">var</span> <span class="nx">directionalLight2</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">DirectionalLight</span><span class="p">(</span><span class="mh">0xffffff</span><span class="p">);</span>
    <span class="nx">directionalLight2</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span> <span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">50</span> <span class="p">).</span><span class="nx">normalize</span><span class="p">();</span>
    <span class="kd">var</span> <span class="nx">directionalLight3</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">DirectionalLight</span><span class="p">(</span><span class="mh">0xffffff</span><span class="p">);</span>
    <span class="nx">directionalLight3</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span> <span class="o">-</span><span class="mi">500</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">500</span> <span class="p">).</span><span class="nx">normalize</span><span class="p">();</span>
    <span class="kd">var</span> <span class="nx">directionalLight4</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">DirectionalLight</span><span class="p">(</span><span class="mh">0xffffff</span><span class="p">);</span>
    <span class="nx">directionalLight4</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span> <span class="o">-</span><span class="mi">500</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="o">-</span><span class="mi">1000</span> <span class="p">).</span><span class="nx">normalize</span><span class="p">();</span>
    <span class="nx">scene</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span> <span class="nx">directionalLight</span> <span class="p">);</span>
</code></pre></div></div>

<h4 id="create-ground">Create Ground</h4>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="c1">//ground</span>
    <span class="nx">walls</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Object3D</span><span class="p">();</span>
    <span class="kd">var</span> <span class="nx">living_area</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Object3D</span><span class="p">();</span>
    <span class="kd">var</span> <span class="nx">groundGeo</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">PlaneGeometry</span><span class="p">(</span><span class="mi">10000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">);</span>

    <span class="kd">var</span> <span class="nx">groundGeo</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">PlaneGeometry</span><span class="p">(</span><span class="mi">10000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">);</span>

    <span class="kd">var</span> <span class="nx">floorTexture</span> <span class="o">=</span> <span class="k">new</span>  <span class="nx">THREE</span><span class="p">.</span><span class="nx">MeshBasicMaterial</span><span class="p">(</span> <span class="p">{</span><span class="na">color</span><span class="p">:</span> <span class="mh">0xffffff</span><span class="p">,</span>  <span class="na">map</span><span class="p">:</span> <span class="nx">loader</span><span class="p">.</span><span class="nx">load</span><span class="p">(</span><span class="dl">'</span><span class="s1">textures/walls/floor2.jpg</span><span class="dl">'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">texture</span><span class="p">){</span>
        <span class="nx">texture</span><span class="p">.</span><span class="nx">needsUpdate</span><span class="o">=</span><span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="p">)});</span>

    <span class="kd">var</span> <span class="nx">ground</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Mesh</span><span class="p">(</span><span class="nx">groundGeo</span><span class="p">,</span> <span class="nx">floorTexture</span><span class="p">);</span>
        <span class="nx">ground</span><span class="p">.</span><span class="nx">overdraw</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="nx">ground</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="nx">wallWidth</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
        <span class="nx">ground</span><span class="p">.</span><span class="nx">rotation</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="o">-</span><span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
        <span class="nx">walls</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">ground</span><span class="p">);</span>
</code></pre></div></div>

<h4 id="sample-adding-ceiling-light-to-living-area">Sample Adding Ceiling Light to Living Area</h4>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="c1">//CeilingLight from tv number1 </span>
    <span class="kd">var</span> <span class="nx">ceilinglight</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">PointLight</span><span class="p">(</span> <span class="mh">0xff9d2a</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">488</span><span class="p">);</span>
        <span class="nx">ceilinglight</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="o">-</span><span class="mi">850</span><span class="o">*</span><span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="nx">wallWidth</span><span class="o">+</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">205</span><span class="o">*</span><span class="mi">5</span> <span class="p">);</span>
        <span class="nx">ceilinglight</span><span class="p">.</span><span class="nx">rotation</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="o">-</span><span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="o">/</span><span class="mi">2</span><span class="p">);</span>
        <span class="nx">ceilinglight</span><span class="p">.</span><span class="nx">shadowCameraVisible</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="nx">ceilinglight</span><span class="p">.</span><span class="nx">shadowDarkness</span> <span class="o">=</span> <span class="mf">0.95</span><span class="p">;</span>
        <span class="nx">ceilinglight</span><span class="p">.</span><span class="nx">intensity</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>
        <span class="nx">ceilinglight</span><span class="p">.</span><span class="nx">castShadow</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>

    <span class="nx">living_area</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">ceilinglight</span><span class="p">);</span>
</code></pre></div></div>

<h4 id="add-wall-3d-objectdae-to-scenes-wall-element">Add Wall 3D Object.Dae to Scene’s Wall Element</h4>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="cm">/************************************************
    *           ColladaLoader For Dae               *
    ************************************************/</span>

    <span class="kd">var</span> <span class="nx">colladaLoader1</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">ColladaLoader</span><span class="p">();</span>
        <span class="nx">colladaLoader1</span><span class="p">.</span><span class="nx">load</span><span class="p">(</span><span class="dl">'</span><span class="s1">Dae/wall.dae</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">object</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">object</span><span class="p">.</span><span class="nx">scene</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="o">-</span><span class="mi">1000</span><span class="o">*</span><span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="nx">wallWidth</span><span class="p">,</span> <span class="o">-</span><span class="mi">1000</span><span class="o">*</span><span class="mi">5</span><span class="p">);</span>
            <span class="nx">object</span><span class="p">.</span><span class="nx">scene</span><span class="p">.</span><span class="nx">rotation</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="o">-</span><span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="o">/</span><span class="mi">2</span><span class="p">);</span>
            <span class="nx">object</span><span class="p">.</span><span class="nx">scene</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span>
            <span class="nx">object</span><span class="p">.</span><span class="nx">name</span><span class="o">=</span><span class="dl">"</span><span class="s2">wall</span><span class="dl">"</span><span class="p">;</span>
            <span class="nx">walls</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span> <span class="nx">object</span><span class="p">.</span><span class="nx">scene</span> <span class="p">);</span>
        <span class="p">});</span>
</code></pre></div></div>

<h4 id="add-a-moving-cube-represents-self-to-simulate-self-move-rotate">Add A Moving Cube Represents Self (To Simulate self move, rotate)</h4>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="c1">// create an array with six textures for a cool cube</span>
    <span class="kd">var</span> <span class="nx">materialArray</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="nx">materialArray</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span>
        <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">MeshBasicMaterial</span><span class="p">(</span> <span class="p">{</span> <span class="na">map</span><span class="p">:</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">ImageUtils</span><span class="p">.</span><span class="nx">loadTexture</span><span class="p">(</span> <span class="dl">'</span><span class="s1">img/xpos.png</span><span class="dl">'</span> <span class="p">)</span> <span class="p">}));</span>
    <span class="nx">materialArray</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span>
        <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">MeshBasicMaterial</span><span class="p">(</span> <span class="p">{</span> <span class="na">map</span><span class="p">:</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">ImageUtils</span><span class="p">.</span><span class="nx">loadTexture</span><span class="p">(</span> <span class="dl">'</span><span class="s1">img/xneg.png</span><span class="dl">'</span> <span class="p">)</span> <span class="p">}));</span>
    <span class="nx">materialArray</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span>
        <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">MeshBasicMaterial</span><span class="p">(</span> <span class="p">{</span> <span class="na">map</span><span class="p">:</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">ImageUtils</span><span class="p">.</span><span class="nx">loadTexture</span><span class="p">(</span> <span class="dl">'</span><span class="s1">img/ypos.png</span><span class="dl">'</span> <span class="p">)</span> <span class="p">}));</span>
    <span class="nx">materialArray</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span>
        <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">MeshBasicMaterial</span><span class="p">(</span> <span class="p">{</span> <span class="na">map</span><span class="p">:</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">ImageUtils</span><span class="p">.</span><span class="nx">loadTexture</span><span class="p">(</span> <span class="dl">'</span><span class="s1">img/yneg.png</span><span class="dl">'</span> <span class="p">)</span> <span class="p">}));</span>
    <span class="nx">materialArray</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span>
        <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">MeshBasicMaterial</span><span class="p">(</span> <span class="p">{</span> <span class="na">map</span><span class="p">:</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">ImageUtils</span><span class="p">.</span><span class="nx">loadTexture</span><span class="p">(</span> <span class="dl">'</span><span class="s1">img/zpos.png</span><span class="dl">'</span> <span class="p">)</span> <span class="p">}));</span>
    <span class="nx">materialArray</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span>
        <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">MeshBasicMaterial</span><span class="p">(</span> <span class="p">{</span> <span class="na">map</span><span class="p">:</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">ImageUtils</span><span class="p">.</span><span class="nx">loadTexture</span><span class="p">(</span> <span class="dl">'</span><span class="s1">img/zneg.png</span><span class="dl">'</span> <span class="p">)</span> <span class="p">}));</span>
    <span class="kd">var</span> <span class="nx">MovingCubeMat</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">MeshFaceMaterial</span><span class="p">(</span><span class="nx">materialArray</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">MovingCubeGeom</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">CubeGeometry</span><span class="p">(</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">materialArray</span> <span class="p">);</span>

    <span class="nx">MovingCube</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Mesh</span><span class="p">(</span> <span class="nx">MovingCubeGeom</span><span class="p">,</span> <span class="nx">MovingCubeMat</span> <span class="p">);</span>
    <span class="nx">MovingCube</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="mi">3100</span><span class="p">,</span> <span class="o">-</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">2100</span><span class="p">);</span>
    <span class="nx">MovingCube</span><span class="p">.</span><span class="nx">rotation</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
    <span class="nx">MovingCube</span><span class="p">.</span><span class="nx">castShadow</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>

    <span class="nx">scene</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span> <span class="nx">MovingCube</span> <span class="p">);</span>  
    <span class="nx">scene</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">living_area</span><span class="p">);</span>
    <span class="nx">scene</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">walls</span><span class="p">);</span>
    <span class="nx">scene</span><span class="p">.</span><span class="nx">simulate</span><span class="p">();</span>
    <span class="nx">renderer</span><span class="p">.</span><span class="nx">shadowMap</span><span class="p">.</span><span class="nx">Enabled</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
    <span class="nx">id</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span> <span class="nx">renderer</span><span class="p">.</span><span class="nx">domElement</span> <span class="p">);</span>
</code></pre></div></div>

<h4 id="simulate-scene">Simulate Scene</h4>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nx">requestAnimationFrame</span><span class="p">(</span> <span class="nx">animate</span> <span class="p">);</span>
    <span class="nx">scene</span><span class="p">.</span><span class="nx">simulate</span><span class="p">();</span>
</code></pre></div></div>

<h4 id="update-animation-moving">Update Animation Moving</h4>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
                    <span class="nx">scene</span><span class="p">.</span><span class="nx">simulate</span><span class="p">(</span><span class="kc">undefined</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
                    <span class="kd">var</span> <span class="nx">delta</span> <span class="o">=</span> <span class="nx">clock</span><span class="p">.</span><span class="nx">getDelta</span><span class="p">();</span> <span class="c1">// seconds.</span>
                    <span class="kd">var</span> <span class="nx">moveDistance</span> <span class="o">=</span> <span class="mi">400</span> <span class="o">*</span> <span class="nx">delta</span><span class="p">;</span> <span class="c1">// 400 pixels per second</span>
                    <span class="kd">var</span> <span class="nx">rotateAngle</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span> <span class="o">/</span> <span class="mi">6</span> <span class="o">*</span> <span class="nx">delta</span><span class="p">;</span>   <span class="c1">// pi/2 radians (45 degrees) per second</span>
                    
                    <span class="c1">// local transformations</span>

                    <span class="c1">// move forwards/backwards/left/right</span>
                    <span class="k">if</span> <span class="p">(</span> <span class="nx">keyboard</span><span class="p">.</span><span class="nx">pressed</span><span class="p">(</span><span class="dl">"</span><span class="s2">W</span><span class="dl">"</span><span class="p">)</span> <span class="p">){</span>
                        <span class="k">if</span><span class="p">(</span><span class="nx">MovingCube</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">y</span><span class="o">&lt;</span> <span class="o">-</span><span class="mi">2200</span> <span class="o">||</span> <span class="nx">MovingCube</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">y</span><span class="o">&gt;</span> <span class="o">-</span><span class="mi">1800</span> <span class="p">){</span>
                            <span class="nx">MovingCube</span><span class="p">.</span><span class="nx">rotation</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
                            <span class="nx">MovingCube</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">y</span><span class="o">=-</span><span class="mi">2200</span><span class="p">;</span>
                        <span class="p">}</span>   
                        <span class="k">else</span>
                            <span class="nx">MovingCube</span><span class="p">.</span><span class="nx">translateZ</span><span class="p">(</span> <span class="o">-</span><span class="nx">moveDistance</span><span class="o">*</span><span class="mf">1.5</span> <span class="p">);</span>
                    <span class="p">}</span>
                    <span class="k">if</span> <span class="p">(</span> <span class="nx">keyboard</span><span class="p">.</span><span class="nx">pressed</span><span class="p">(</span><span class="dl">"</span><span class="s2">S</span><span class="dl">"</span><span class="p">)</span> <span class="p">){</span>
                        <span class="k">if</span><span class="p">(</span><span class="nx">MovingCube</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">y</span><span class="o">&lt;</span> <span class="o">-</span><span class="mi">2200</span> <span class="o">||</span> <span class="nx">MovingCube</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">y</span><span class="o">&gt;</span> <span class="o">-</span><span class="mi">1800</span> <span class="p">){</span>
                            <span class="nx">MovingCube</span><span class="p">.</span><span class="nx">rotation</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
                            <span class="nx">MovingCube</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">y</span><span class="o">=-</span><span class="mi">2200</span><span class="p">;</span>
                        <span class="p">}</span>
                        <span class="k">else</span>
                            <span class="nx">MovingCube</span><span class="p">.</span><span class="nx">translateZ</span><span class="p">(</span>  <span class="nx">moveDistance</span><span class="o">*</span><span class="mf">1.5</span> <span class="p">);</span>
                    <span class="p">}</span>
                    <span class="k">if</span> <span class="p">(</span> <span class="nx">keyboard</span><span class="p">.</span><span class="nx">pressed</span><span class="p">(</span><span class="dl">"</span><span class="s2">A</span><span class="dl">"</span><span class="p">)</span> <span class="p">){</span>
                        <span class="k">if</span><span class="p">(</span><span class="nx">MovingCube</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">y</span><span class="o">&lt;</span> <span class="o">-</span><span class="mi">2200</span> <span class="o">||</span> <span class="nx">MovingCube</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">y</span><span class="o">&gt;</span> <span class="o">-</span><span class="mi">1800</span> <span class="p">){</span>
                            <span class="nx">MovingCube</span><span class="p">.</span><span class="nx">rotation</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
                            <span class="nx">MovingCube</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">y</span><span class="o">=-</span><span class="mi">2200</span><span class="p">;</span>
                        <span class="p">}</span>
                        <span class="k">else</span>
                            <span class="nx">MovingCube</span><span class="p">.</span><span class="nx">translateX</span><span class="p">(</span> <span class="o">-</span><span class="nx">moveDistance</span><span class="o">*</span><span class="mf">1.5</span> <span class="p">);</span>
                    <span class="p">}</span>
                    <span class="k">if</span> <span class="p">(</span> <span class="nx">keyboard</span><span class="p">.</span><span class="nx">pressed</span><span class="p">(</span><span class="dl">"</span><span class="s2">D</span><span class="dl">"</span><span class="p">)</span> <span class="p">){</span>
                        <span class="k">if</span><span class="p">(</span><span class="nx">MovingCube</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">y</span><span class="o">&lt;</span> <span class="o">-</span><span class="mi">2200</span> <span class="o">||</span> <span class="nx">MovingCube</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">y</span><span class="o">&gt;</span> <span class="o">-</span><span class="mi">1800</span> <span class="p">){</span>
                            <span class="nx">MovingCube</span><span class="p">.</span><span class="nx">rotation</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
                            <span class="nx">MovingCube</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">y</span><span class="o">=-</span><span class="mi">2200</span><span class="p">;</span>
                        <span class="p">}</span>
                        <span class="k">else</span>
                            <span class="nx">MovingCube</span><span class="p">.</span><span class="nx">translateX</span><span class="p">(</span>  <span class="nx">moveDistance</span><span class="o">*</span><span class="mf">1.5</span> <span class="p">);</span>   
                    <span class="p">}</span>

                    <span class="c1">// rotate left/right/up/down  velocity</span>
                    <span class="kd">var</span> <span class="nx">rotation_matrix</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Matrix4</span><span class="p">().</span><span class="nx">identity</span><span class="p">();</span>
                    
                    <span class="k">if</span> <span class="p">(</span> <span class="nx">keyboard</span><span class="p">.</span><span class="nx">pressed</span><span class="p">(</span><span class="dl">"</span><span class="s2">Z</span><span class="dl">"</span><span class="p">)</span> <span class="p">)</span>
                    <span class="p">{</span>
                        <span class="nx">MovingCube</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="nx">wallWidth</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
                        <span class="nx">MovingCube</span><span class="p">.</span><span class="nx">rotation</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="o">-</span><span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
                        <span class="nx">render</span><span class="p">();</span>
                    <span class="p">}</span>
                    
                    <span class="kd">var</span> <span class="nx">relativeCameraOffset</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Vector3</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
                    <span class="kd">var</span> <span class="nx">cameraOffset</span> <span class="o">=</span><span class="nx">relativeCameraOffset</span><span class="p">.</span><span class="nx">applyMatrix4</span><span class="p">(</span><span class="nx">MovingCube</span><span class="p">.</span><span class="nx">matrixWorld</span><span class="p">);</span>
                    <span class="nx">textureCamera</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="nx">cameraOffset</span><span class="p">.</span><span class="nx">x</span><span class="p">;</span>
                    <span class="nx">textureCamera</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="nx">cameraOffset</span><span class="p">.</span><span class="nx">y</span><span class="p">;</span>
                    <span class="nx">textureCamera</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">z</span> <span class="o">=</span> <span class="nx">cameraOffset</span><span class="p">.</span><span class="nx">z</span><span class="p">;</span>
                    <span class="kd">var</span> <span class="nx">relativeCameraLookOffset</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Vector3</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
                    <span class="kd">var</span> <span class="nx">cameraLookOffset</span> <span class="o">=</span> <span class="nx">relativeCameraLookOffset</span><span class="p">.</span><span class="nx">applyMatrix4</span><span class="p">(</span> <span class="nx">MovingCube</span><span class="p">.</span><span class="nx">matrixWorld</span> <span class="p">);</span>
                    <span class="nx">textureCamera</span><span class="p">.</span><span class="nx">lookAt</span><span class="p">(</span> <span class="nx">cameraLookOffset</span> <span class="p">);</span>
                    <span class="nx">stats</span><span class="p">.</span><span class="nx">update</span><span class="p">();</span>
</code></pre></div></div>



  <small>tags: <em>ThreeJS</em></small>



      </section>
      <footer>
        
      </footer>
    </div>
    <script src="/assets/js/scale.fix.js"></script>
    
  </body>
</html>
